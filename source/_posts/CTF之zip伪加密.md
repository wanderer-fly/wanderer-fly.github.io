---
title: CTF之zip伪加密
date: 2025-11-19 14:51:01
tags: 
    - CTF
    - Misc
---

# CTF之zip伪加密

题目只有一个zip，下载下来提示需要输入密码

zip伪加密的原理是在文件头加密标志位做修改，使文件打开时被识别为加密的zip，实际上并没有密码。

## 解题过程

使用任意16进制编辑器打开该zip文件，得到：

```
Downloads ❯ xxd zip伪加密.zip
00000000: 504b 0304 1400 0900 0800 50a3 a54a 2138  PK........P..J!8
00000010: 7665 1900 0000 1700 0000 0800 0000 666c  ve............fl
00000020: 6167 2e74 7874 4bcb 494c af76 4cc9 35f4  ag.txtK.IL.vL.5.
00000030: d375 3272 d7cd 0ed5 0d8e f20c a805 0050  .u2r...........P
00000040: 4b01 021f 0014 0009 0008 0050 a3a5 4a21  K..........P..J!
00000050: 3876 6519 0000 0017 0000 0008 0024 0000  8ve..........$..
00000060: 0000 0000 0020 0000 0000 0000 0066 6c61  ..... .......fla
00000070: 672e 7478 740a 0020 0000 0000 0001 0018  g.txt.. ........
00000080: 000f f504 d59a c5d2 0146 1fcb 8a9a c5d2  .........F......
00000090: 0146 1fcb 8a9a c5d2 0150 4b05 0600 0000  .F.......PK.....
000000a0: 0001 0001 005a 0000 003f 0000 0000 00    .....Z...?.....
Downloads ❯
```

其中，`504b 0304`开头部分为**压缩源文件数据区**

`504b 0304`是文件头标记

`1400` 表示解压文件需要的pkware版本

`0900` 表示文件是否加密

`0800` 为压缩方式

`50a3` 为最后修改时间

`a54a` 为最后修改日期

但是我们要修改的地方在**压缩源文件目录区**，因此我们要定位到`504b 0102`部分，这才是压缩源文件目录区的开头标记

`1f00`表示压缩使用的pkware版本，`1400`表示解压文件所需pkware版本，接下来的`0900`表示文件是否加密，这里改为`0000`即可

修改完后直接解压文件，得到flag.txt，打开得到flag
